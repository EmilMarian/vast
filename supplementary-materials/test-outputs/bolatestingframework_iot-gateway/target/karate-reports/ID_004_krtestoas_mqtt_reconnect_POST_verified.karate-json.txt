{"failedCount":0,"prefixedPath":"classpath:ID_004_krtestoas_mqtt_reconnect_POST_verified.feature","packageQualifiedName":"ID_004_krtestoas_mqtt_reconnect_POST_verified","loopIndex":-1,"relativePath":"ID_004_krtestoas_mqtt_reconnect_POST_verified.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":349800,"startTime":1742993536846,"endTime":1742993536846,"millis":0.3498,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"url 'http:\/\/192.168.1.109:48080'"}},{"result":{"nanos":893100,"startTime":1742993536847,"endTime":1742993536848,"millis":0.8931,"status":"passed"},"step":{"comments":["# First access a legitimate user's sensors"],"line":8,"prefix":"Given","index":0,"text":"path '\/users\/user1\/sensors'"}},{"result":{"nanos":25711400,"startTime":1742993536848,"endTime":1742993536874,"millis":25.7114,"status":"passed"},"step":{"line":9,"prefix":"When","index":1,"text":"method get"},"stepLog":"14:52:16.851 request:\n1 > GET http:\/\/192.168.1.109:48080\/users\/user1\/sensors\n1 > Host: 192.168.1.109:48080\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n1 > Accept-Encoding: gzip,deflate\n\n\n14:52:16.869 response time in milliseconds: 17\n1 < 200\n1 < Content-Type: application\/json\n1 < Content-Length: 845\n1 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n1 < Date: Wed, 26 Mar 2025 12:52:18 GMT\n{\"TEMP001\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865408.562495,\"location\":\"greenhouse-1\",\"sensor_id\":\"TEMP001\",\"temperature\":24.139999389648438,\"timestamp\":1742865408,\"type\":\"temperature\",\"unit\":\"celsius\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":35.0,\"low\":15.0},\"proprietary_settings\":{\"growth_factor\":1.2,\"nutrient_mix\":\"formula-103\"},\"yield_prediction\":\"85.3 tons\/hectare\"}},\"TEMP002\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865405.8499749,\"location\":\"unknown\",\"sensor_id\":\"TEMP002\",\"temperature\":24.32,\"timestamp\":1742865405.0,\"type\":\"unknown\",\"unit\":\"unknown\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":32.0,\"low\":18.0},\"proprietary_settings\":{\"growth_factor\":1.4,\"nutrient_mix\":\"formula-205\"},\"yield_prediction\":\"92.7 tons\/hectare\"}}}\n\n\n"},{"result":{"nanos":17500,"startTime":1742993536874,"endTime":1742993536874,"millis":0.0175,"status":"passed"},"step":{"line":10,"prefix":"Then","index":2,"text":"status 200"}},{"result":{"nanos":1513400,"startTime":1742993536874,"endTime":1742993536876,"millis":1.5134,"status":"passed"},"step":{"line":11,"prefix":"And","index":3,"text":"match response != null"}},{"result":{"nanos":2147000,"startTime":1742993536876,"endTime":1742993536878,"millis":2.147,"status":"passed"},"step":{"line":12,"prefix":"And","index":4,"text":"match response['TEMP001'] != null"}},{"result":{"nanos":580700,"startTime":1742993536878,"endTime":1742993536879,"millis":0.5807,"status":"passed"},"step":{"comments":["# Test access to different user's sensors without authentication (BOLA vulnerability)"],"line":15,"prefix":"Given","index":5,"text":"path '\/users\/premium_user\/sensors'"}},{"result":{"nanos":30193400,"startTime":1742993536879,"endTime":1742993536909,"millis":30.1934,"status":"passed"},"step":{"line":16,"prefix":"When","index":6,"text":"method get"},"stepLog":"14:52:16.891 request:\n2 > GET http:\/\/192.168.1.109:48080\/users\/premium_user\/sensors\n2 > Host: 192.168.1.109:48080\n2 > Connection: Keep-Alive\n2 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n2 > Accept-Encoding: gzip,deflate\n\n\n14:52:16.907 response time in milliseconds: 16\n2 < 200\n2 < Content-Type: application\/json\n2 < Content-Length: 480\n2 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n2 < Date: Wed, 26 Mar 2025 12:52:18 GMT\n{\"TEMP004\":{\"basic_data\":{\"gateway_timestamp\":1742865407.0622792,\"sensor_id\":\"TEMP004\",\"temperature\":24.6,\"timestamp\":1742865407.0611646,\"unit\":\"celsius\"},\"sensitive_data\":{\"advanced_metrics\":{\"crop_stress_indicators\":[0.12,0.08,0.15],\"optimal_harvest_window\":\"2025-07-15 to 2025-07-25\",\"soil_health_index\":89.2},\"alert_thresholds\":{\"high\":34.0,\"low\":17.0},\"proprietary_settings\":{\"growth_factor\":1.8,\"nutrient_mix\":\"premium-formula-X\"},\"yield_prediction\":\"105.2 tons\/hectare\"}}}\n\n\n"},{"result":{"nanos":17200,"startTime":1742993536909,"endTime":1742993536909,"millis":0.0172,"status":"passed"},"step":{"line":17,"prefix":"Then","index":7,"text":"status 200  # Should be 403 if properly secured"}},{"result":{"nanos":705200,"startTime":1742993536909,"endTime":1742993536910,"millis":0.7052,"status":"passed"},"step":{"line":18,"prefix":"And","index":8,"text":"match response != null"}},{"result":{"nanos":1927000,"startTime":1742993536910,"endTime":1742993536912,"millis":1.927,"status":"passed"},"step":{"line":19,"prefix":"And","index":9,"text":"match response['TEMP004'] != null"}},{"result":{"nanos":969100,"startTime":1742993536912,"endTime":1742993536913,"millis":0.9691,"status":"passed"},"step":{"line":20,"prefix":"And","index":10,"text":"match response['TEMP004'].sensitive_data != null"}},{"result":{"nanos":806200,"startTime":1742993536913,"endTime":1742993536914,"millis":0.8062,"status":"passed"},"step":{"comments":["# Test access to admin user's sensors without authentication (BOLA vulnerability)"],"line":23,"prefix":"Given","index":11,"text":"path '\/users\/admin\/sensors'"}},{"result":{"nanos":16994700,"startTime":1742993536914,"endTime":1742993536931,"millis":16.9947,"status":"passed"},"step":{"line":24,"prefix":"When","index":12,"text":"method get"},"stepLog":"14:52:16.917 request:\n3 > GET http:\/\/192.168.1.109:48080\/users\/admin\/sensors\n3 > Host: 192.168.1.109:48080\n3 > Connection: Keep-Alive\n3 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n3 > Accept-Encoding: gzip,deflate\n\n\n14:52:16.928 response time in milliseconds: 11\n3 < 200\n3 < Content-Type: application\/json\n3 < Content-Length: 1323\n3 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n3 < Date: Wed, 26 Mar 2025 12:52:18 GMT\n{\"TEMP001\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865408.562495,\"location\":\"greenhouse-1\",\"sensor_id\":\"TEMP001\",\"temperature\":24.139999389648438,\"timestamp\":1742865408,\"type\":\"temperature\",\"unit\":\"celsius\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":35.0,\"low\":15.0},\"proprietary_settings\":{\"growth_factor\":1.2,\"nutrient_mix\":\"formula-103\"},\"yield_prediction\":\"85.3 tons\/hectare\"}},\"TEMP002\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865405.8499749,\"location\":\"unknown\",\"sensor_id\":\"TEMP002\",\"temperature\":24.32,\"timestamp\":1742865405.0,\"type\":\"unknown\",\"unit\":\"unknown\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":32.0,\"low\":18.0},\"proprietary_settings\":{\"growth_factor\":1.4,\"nutrient_mix\":\"formula-205\"},\"yield_prediction\":\"92.7 tons\/hectare\"}},\"TEMP004\":{\"basic_data\":{\"gateway_timestamp\":1742865407.0622792,\"sensor_id\":\"TEMP004\",\"temperature\":24.6,\"timestamp\":1742865407.0611646,\"unit\":\"celsius\"},\"sensitive_data\":{\"advanced_metrics\":{\"crop_stress_indicators\":[0.12,0.08,0.15],\"optimal_harvest_window\":\"2025-07-15 to 2025-07-25\",\"soil_health_index\":89.2},\"alert_thresholds\":{\"high\":34.0,\"low\":17.0},\"proprietary_settings\":{\"growth_factor\":1.8,\"nutrient_mix\":\"premium-formula-X\"},\"yield_prediction\":\"105.2 tons\/hectare\"}}}\n\n\n"},{"result":{"nanos":20600,"startTime":1742993536931,"endTime":1742993536931,"millis":0.0206,"status":"passed"},"step":{"line":25,"prefix":"Then","index":13,"text":"status 200  # Should be 403 if properly secured"}},{"result":{"nanos":843900,"startTime":1742993536932,"endTime":1742993536933,"millis":0.8439,"status":"passed"},"step":{"line":26,"prefix":"And","index":14,"text":"match response != null"}},{"result":{"nanos":589300,"startTime":1742993536933,"endTime":1742993536934,"millis":0.5893,"status":"passed"},"step":{"comments":["# Test access to non-existent user"],"line":29,"prefix":"Given","index":15,"text":"path '\/users\/nonexistent\/sensors'"}},{"result":{"nanos":27695800,"startTime":1742993536933,"endTime":1742993536961,"millis":27.6958,"status":"passed"},"step":{"line":30,"prefix":"When","index":16,"text":"method get"},"stepLog":"14:52:16.940 request:\n4 > GET http:\/\/192.168.1.109:48080\/users\/nonexistent\/sensors\n4 > Host: 192.168.1.109:48080\n4 > Connection: Keep-Alive\n4 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n4 > Accept-Encoding: gzip,deflate\n\n\n14:52:16.960 response time in milliseconds: 19\n4 < 404\n4 < Content-Type: application\/json\n4 < Content-Length: 39\n4 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n4 < Date: Wed, 26 Mar 2025 12:52:18 GMT\n{\"error\":\"User nonexistent not found\"}\n\n\n"},{"result":{"nanos":21600,"startTime":1742993536962,"endTime":1742993536962,"millis":0.0216,"status":"passed"},"step":{"line":31,"prefix":"Then","index":17,"text":"status 404"}},{"result":{"nanos":1776100,"startTime":1742993536962,"endTime":1742993536964,"millis":1.7761,"status":"passed"},"step":{"line":32,"prefix":"And","index":18,"text":"match response.error == 'User nonexistent not found'"}}],"executorName":"main","line":6,"name":"Test authorization bypass through user ID enumeration","description":"","durationMillis":113.773,"startTime":1742993536844,"failed":false,"refId":"[1:6]","endTime":1742993536964,"exampleIndex":-1}],"callDepth":0,"name":"IoT Gateway BOLA Vulnerability Tests","description":"","resultDate":"2025-03-26 02:52:16 PM","durationMillis":113.773,"passedCount":1}