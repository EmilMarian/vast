Testing Docker command access...
Docker command access confirmed: sudo docker
Datasets will be saved to: datasets/master_20250423/command_injection
=====================================================
Processing command injection under fault condition: none
=====================================================
Restarting temperature-sensor-04 container to ensure a clean state...
temperature-sensor-04
Waiting for container to fully initialize...
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Collecting baseline data before command injection...
Starting data collection for event: command_injection_none_baseline
Duration: 30 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15
Completed collection with 15 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/none/command_injection_none_baseline_20250423_222951.jsonl
Baseline data collected: datasets/master_20250423/command_injection/none/command_injection_none_baseline_20250423_222951.jsonl
Starting data collection for netcat installation phase...
Data collector running with PID 422197
Installing networking tools on sensor localhost:12384...
Netcat installation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70f67444e340>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Netcat installation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70f67444e340>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for netcat installation data collection to complete...
Starting data collection for event: command_injection_none_install
Duration: 120 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60
Completed collection with 60 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/none/command_injection_none_install_20250423_223022.jsonl
Netcat installation data collected: datasets/master_20250423/command_injection/none/command_injection_none_install_20250423_223022.jsonl
Starting data collection for reverse shell phase...
Data collector running with PID 426199
Establishing reverse shell from sensor localhost:12384 to 172.28.0.8:4444...
Reverse shell initiation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70f67458ac40>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Reverse shell initiation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70f67458ac40>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for reverse shell data collection to complete...
Starting data collection for event: command_injection_none_shell
Duration: 180 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60Collected snapshot 61Collected snapshot 62Collected snapshot 63Collected snapshot 64Collected snapshot 65Collected snapshot 66Collected snapshot 67Collected snapshot 68Collected snapshot 69Collected snapshot 70Collected snapshot 71Collected snapshot 72Collected snapshot 73Collected snapshot 74Collected snapshot 75Collected snapshot 76Collected snapshot 77Collected snapshot 78Collected snapshot 79Collected snapshot 80Collected snapshot 81Collected snapshot 82Collected snapshot 83Collected snapshot 84Collected snapshot 85Collected snapshot 86Collected snapshot 87Collected snapshot 88Collected snapshot 89Collected snapshot 90
Completed collection with 90 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/none/command_injection_none_shell_20250423_223222.jsonl
Reverse shell data collected: datasets/master_20250423/command_injection/none/command_injection_none_shell_20250423_223222.jsonl
Collecting post-event recovery data...
Starting data collection for event: command_injection_none_recovery
Duration: 60 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30
Completed collection with 30 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/none/command_injection_none_recovery_20250423_223522.jsonl
Recovery data collected: datasets/master_20250423/command_injection/none/command_injection_none_recovery_20250423_223522.jsonl
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Cooling down for 60 seconds...
=====================================================
Processing command injection under fault condition: stuck
=====================================================
Restarting temperature-sensor-04 container to ensure a clean state...
temperature-sensor-04
Waiting for container to fully initialize...
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Setting fault mode to: stuck on localhost:12384
Fault mode set response: {
  "fault_mode": "stuck", 
  "status": "success"
}
Collecting baseline data before command injection...
Starting data collection for event: command_injection_stuck_baseline
Duration: 30 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15
Completed collection with 15 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/stuck/command_injection_stuck_baseline_20250423_223751.jsonl
Baseline data collected: datasets/master_20250423/command_injection/stuck/command_injection_stuck_baseline_20250423_223751.jsonl
Starting data collection for netcat installation phase...
Data collector running with PID 437723
Installing networking tools on sensor localhost:12384...
Netcat installation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x798b5270b400>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Netcat installation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x798b5270b400>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for netcat installation data collection to complete...
Starting data collection for event: command_injection_stuck_install
Duration: 120 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60
Completed collection with 60 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/stuck/command_injection_stuck_install_20250423_223821.jsonl
Netcat installation data collected: datasets/master_20250423/command_injection/stuck/command_injection_stuck_install_20250423_223821.jsonl
Starting data collection for reverse shell phase...
Data collector running with PID 440885
Establishing reverse shell from sensor localhost:12384 to 172.28.0.8:4444...
Reverse shell initiation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x798b5271ab80>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Reverse shell initiation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x798b5271ab80>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for reverse shell data collection to complete...
Starting data collection for event: command_injection_stuck_shell
Duration: 180 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60Collected snapshot 61Collected snapshot 62Collected snapshot 63Collected snapshot 64Collected snapshot 65Collected snapshot 66Collected snapshot 67Collected snapshot 68Collected snapshot 69Collected snapshot 70Collected snapshot 71Collected snapshot 72Collected snapshot 73Collected snapshot 74Collected snapshot 75Collected snapshot 76Collected snapshot 77Collected snapshot 78Collected snapshot 79Collected snapshot 80Collected snapshot 81Collected snapshot 82Collected snapshot 83Collected snapshot 84Collected snapshot 85Collected snapshot 86Collected snapshot 87Collected snapshot 88Collected snapshot 89Collected snapshot 90
Completed collection with 90 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/stuck/command_injection_stuck_shell_20250423_224021.jsonl
Reverse shell data collected: datasets/master_20250423/command_injection/stuck/command_injection_stuck_shell_20250423_224021.jsonl
Collecting post-event recovery data...
Starting data collection for event: command_injection_stuck_recovery
Duration: 60 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30
Completed collection with 30 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/stuck/command_injection_stuck_recovery_20250423_224321.jsonl
Recovery data collected: datasets/master_20250423/command_injection/stuck/command_injection_stuck_recovery_20250423_224321.jsonl
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Cooling down for 60 seconds...
=====================================================
Processing command injection under fault condition: drift
=====================================================
Restarting temperature-sensor-04 container to ensure a clean state...
temperature-sensor-04
Waiting for container to fully initialize...
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Setting fault mode to: drift on localhost:12384
Fault mode set response: {
  "fault_mode": "drift", 
  "status": "success"
}
Collecting baseline data before command injection...
Starting data collection for event: command_injection_drift_baseline
Duration: 30 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15
Completed collection with 15 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/drift/command_injection_drift_baseline_20250423_224550.jsonl
Baseline data collected: datasets/master_20250423/command_injection/drift/command_injection_drift_baseline_20250423_224550.jsonl
Starting data collection for netcat installation phase...
Data collector running with PID 452427
Installing networking tools on sensor localhost:12384...
Netcat installation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f84700c84c0>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Netcat installation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f84700c84c0>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for netcat installation data collection to complete...
Starting data collection for event: command_injection_drift_install
Duration: 120 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60
Completed collection with 60 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/drift/command_injection_drift_install_20250423_224620.jsonl
Netcat installation data collected: datasets/master_20250423/command_injection/drift/command_injection_drift_install_20250423_224620.jsonl
Starting data collection for reverse shell phase...
Data collector running with PID 457452
Establishing reverse shell from sensor localhost:12384 to 172.28.0.8:4444...
Reverse shell initiation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f847020afd0>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Reverse shell initiation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f847020afd0>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for reverse shell data collection to complete...
Starting data collection for event: command_injection_drift_shell
Duration: 180 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60Collected snapshot 61Collected snapshot 62Collected snapshot 63Collected snapshot 64Collected snapshot 65Collected snapshot 66Collected snapshot 67Collected snapshot 68Collected snapshot 69Collected snapshot 70Collected snapshot 71Collected snapshot 72Collected snapshot 73Collected snapshot 74Collected snapshot 75Collected snapshot 76Collected snapshot 77Collected snapshot 78Collected snapshot 79Collected snapshot 80Collected snapshot 81Collected snapshot 82Collected snapshot 83Collected snapshot 84Collected snapshot 85Collected snapshot 86Collected snapshot 87Collected snapshot 88Collected snapshot 89Collected snapshot 90
Completed collection with 90 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/drift/command_injection_drift_shell_20250423_224820.jsonl
Reverse shell data collected: datasets/master_20250423/command_injection/drift/command_injection_drift_shell_20250423_224820.jsonl
Collecting post-event recovery data...
Starting data collection for event: command_injection_drift_recovery
Duration: 60 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30
Completed collection with 30 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/drift/command_injection_drift_recovery_20250423_225120.jsonl
Recovery data collected: datasets/master_20250423/command_injection/drift/command_injection_drift_recovery_20250423_225120.jsonl
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Cooling down for 60 seconds...
=====================================================
Processing command injection under fault condition: spike
=====================================================
Restarting temperature-sensor-04 container to ensure a clean state...
temperature-sensor-04
Waiting for container to fully initialize...
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Setting fault mode to: spike on localhost:12384
Fault mode set response: {
  "fault_mode": "spike", 
  "status": "success"
}
Collecting baseline data before command injection...
Starting data collection for event: command_injection_spike_baseline
Duration: 30 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15
Completed collection with 15 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/spike/command_injection_spike_baseline_20250423_225353.jsonl
Baseline data collected: datasets/master_20250423/command_injection/spike/command_injection_spike_baseline_20250423_225353.jsonl
Starting data collection for netcat installation phase...
Data collector running with PID 469107
Installing networking tools on sensor localhost:12384...
Netcat installation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x740cb519df40>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Netcat installation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x740cb519df40>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for netcat installation data collection to complete...
Starting data collection for event: command_injection_spike_install
Duration: 120 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60
Completed collection with 60 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/spike/command_injection_spike_install_20250423_225423.jsonl
Netcat installation data collected: datasets/master_20250423/command_injection/spike/command_injection_spike_install_20250423_225423.jsonl
Starting data collection for reverse shell phase...
Data collector running with PID 472600
Establishing reverse shell from sensor localhost:12384 to 172.28.0.8:4444...
Reverse shell initiation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x740cb520fd90>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Reverse shell initiation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x740cb520fd90>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for reverse shell data collection to complete...
Starting data collection for event: command_injection_spike_shell
Duration: 180 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60Collected snapshot 61Collected snapshot 62Collected snapshot 63Collected snapshot 64Collected snapshot 65Collected snapshot 66Collected snapshot 67Collected snapshot 68Collected snapshot 69Collected snapshot 70Collected snapshot 71Collected snapshot 72Collected snapshot 73Collected snapshot 74Collected snapshot 75Collected snapshot 76Collected snapshot 77Collected snapshot 78Collected snapshot 79Collected snapshot 80Collected snapshot 81Collected snapshot 82Collected snapshot 83Collected snapshot 84Collected snapshot 85Collected snapshot 86Collected snapshot 87Collected snapshot 88Collected snapshot 89Collected snapshot 90
Completed collection with 90 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/spike/command_injection_spike_shell_20250423_225624.jsonl
Reverse shell data collected: datasets/master_20250423/command_injection/spike/command_injection_spike_shell_20250423_225624.jsonl
Collecting post-event recovery data...
Starting data collection for event: command_injection_spike_recovery
Duration: 60 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30
Completed collection with 30 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/spike/command_injection_spike_recovery_20250423_225924.jsonl
Recovery data collected: datasets/master_20250423/command_injection/spike/command_injection_spike_recovery_20250423_225924.jsonl
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Cooling down for 60 seconds...
=====================================================
Processing command injection under fault condition: dropout
=====================================================
Restarting temperature-sensor-04 container to ensure a clean state...
temperature-sensor-04
Waiting for container to fully initialize...
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Setting fault mode to: dropout on localhost:12384
Fault mode set response: {
  "fault_mode": "dropout", 
  "status": "success"
}
Collecting baseline data before command injection...
Starting data collection for event: command_injection_dropout_baseline
Duration: 30 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15
Completed collection with 15 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/dropout/command_injection_dropout_baseline_20250423_230152.jsonl
Baseline data collected: datasets/master_20250423/command_injection/dropout/command_injection_dropout_baseline_20250423_230152.jsonl
Starting data collection for netcat installation phase...
Data collector running with PID 484150
Installing networking tools on sensor localhost:12384...
Netcat installation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70c6f471e3a0>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Netcat installation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70c6f471e3a0>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for netcat installation data collection to complete...
Starting data collection for event: command_injection_dropout_install
Duration: 120 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60
Completed collection with 60 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/dropout/command_injection_dropout_install_20250423_230223.jsonl
Netcat installation data collected: datasets/master_20250423/command_injection/dropout/command_injection_dropout_install_20250423_230223.jsonl
Starting data collection for reverse shell phase...
Data collector running with PID 487347
Establishing reverse shell from sensor localhost:12384 to 172.28.0.8:4444...
Reverse shell initiation response: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70c6f4730700>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Reverse shell initiation failed: {
  "message": "HTTPConnectionPool(host='172.28.0.8', port=63999): Max retries exceeded with url: /dummy.sh (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70c6f4730700>: Failed to establish a new connection: [Errno 111] Connection refused'))", 
  "status": "error"
}
Waiting for reverse shell data collection to complete...
Starting data collection for event: command_injection_dropout_shell
Duration: 180 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30Collected snapshot 31Collected snapshot 32Collected snapshot 33Collected snapshot 34Collected snapshot 35Collected snapshot 36Collected snapshot 37Collected snapshot 38Collected snapshot 39Collected snapshot 40Collected snapshot 41Collected snapshot 42Collected snapshot 43Collected snapshot 44Collected snapshot 45Collected snapshot 46Collected snapshot 47Collected snapshot 48Collected snapshot 49Collected snapshot 50Collected snapshot 51Collected snapshot 52Collected snapshot 53Collected snapshot 54Collected snapshot 55Collected snapshot 56Collected snapshot 57Collected snapshot 58Collected snapshot 59Collected snapshot 60Collected snapshot 61Collected snapshot 62Collected snapshot 63Collected snapshot 64Collected snapshot 65Collected snapshot 66Collected snapshot 67Collected snapshot 68Collected snapshot 69Collected snapshot 70Collected snapshot 71Collected snapshot 72Collected snapshot 73Collected snapshot 74Collected snapshot 75Collected snapshot 76Collected snapshot 77Collected snapshot 78Collected snapshot 79Collected snapshot 80Collected snapshot 81Collected snapshot 82Collected snapshot 83Collected snapshot 84Collected snapshot 85Collected snapshot 86Collected snapshot 87Collected snapshot 88Collected snapshot 89Collected snapshot 90
Completed collection with 90 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/dropout/command_injection_dropout_shell_20250423_230423.jsonl
Reverse shell data collected: datasets/master_20250423/command_injection/dropout/command_injection_dropout_shell_20250423_230423.jsonl
Collecting post-event recovery data...
Starting data collection for event: command_injection_dropout_recovery
Duration: 60 seconds, Interval: 2 seconds
Collected snapshot 1Collected snapshot 2Collected snapshot 3Collected snapshot 4Collected snapshot 5Collected snapshot 6Collected snapshot 7Collected snapshot 8Collected snapshot 9Collected snapshot 10Collected snapshot 11Collected snapshot 12Collected snapshot 13Collected snapshot 14Collected snapshot 15Collected snapshot 16Collected snapshot 17Collected snapshot 18Collected snapshot 19Collected snapshot 20Collected snapshot 21Collected snapshot 22Collected snapshot 23Collected snapshot 24Collected snapshot 25Collected snapshot 26Collected snapshot 27Collected snapshot 28Collected snapshot 29Collected snapshot 30
Completed collection with 30 snapshots.
Dataset saved to: datasets/master_20250423/command_injection/dropout/command_injection_dropout_recovery_20250423_230723.jsonl
Recovery data collected: datasets/master_20250423/command_injection/dropout/command_injection_dropout_recovery_20250423_230723.jsonl
Setting fault mode to: none on localhost:12384
Fault mode set response: {
  "fault_mode": "none", 
  "status": "success"
}
Cooling down for 60 seconds...
=====================================================
Command injection dataset collection complete!
=====================================================
Master metadata file: datasets/master_20250423/command_injection/command_injection_dataset_master_20250423_222919.json

To process this data into CSV format, run:
python3 command_injection_processor_refactored.py --metadata datasets/master_20250423/command_injection/command_injection_dataset_master_20250423_222919.json
